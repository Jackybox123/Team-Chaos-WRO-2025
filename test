from sense_hat import SenseHat
import time

# Initialize the Sense HAT
sense = SenseHat()

# -------------------------
# 1. Display Scrolling Text
# -------------------------
sense.show_message("Hello!", scroll_speed=0.1, text_colour=(255, 0, 0), back_colour=(0, 0, 0))
time.sleep(1)

# -------------------------
# 2. Set a Specific Pixel
# -------------------------
sense.clear()
sense.set_pixel(3, 3, (0, 255, 0))
time.sleep(1)

# -------------------------
# 3. Show a Custom 8x8 Image
# -------------------------
green = (0, 255, 0)
red = (255, 0, 0)
blank = (0, 0, 0)

image = [
    green, green, blank, blank, blank, blank, green, green,
    green, green, blank, blank, blank, blank, green, green,
    blank, blank, red, red, red, red, blank, blank,
    blank, blank, red, red, red, red, blank, blank,
    blank, blank, red, red, red, red, blank, blank,
    blank, blank, red, red, red, red, blank, blank,
    green, green, blank, blank, blank, blank, green, green,
    green, green, blank, blank, blank, blank, green, green,
]
sense.set_pixels(image)
time.sleep(2)

# -------------------------
# 4. Read and Print Environmental Data
# -------------------------
temp = sense.get_temperature()
humidity = sense.get_humidity()
pressure = sense.get_pressure()

print(f"Temperature: {temp:.1f} C")
print(f"Humidity: {humidity:.1f}%")
print(f"Pressure: {pressure:.1f} hPa")
time.sleep(2)

# -------------------------
# 5. Read and Print Accelerometer Data
# -------------------------
accel = sense.get_accelerometer_raw()
print(f"Accelerometer - x={accel['x']:.3f}, y={accel['y']:.3f}, z={accel['z']:.3f}")
time.sleep(2)

# -------------------------
# 6. Read and Print Gyroscope Orientation (Pitch, Roll, Yaw)
# -------------------------
print("Gyroscope orientation test starting...")
gyro_start = time.time()
while time.time() - gyro_start < 5:  # Run for 5 seconds
    orientation = sense.get_orientation()
    pitch = orientation['pitch']
    roll = orientation['roll']
    yaw = orientation['yaw']
    print(f"Pitch={pitch:.2f}, Roll={roll:.2f}, Yaw={yaw:.2f}")
    time.sleep(0.5)

# -------------------------
# 7. Shake Detection
# -------------------------
print("Shake detection started. Move the Pi to test...")
start_time = time.time()
while time.time() - start_time < 10:
    acceleration = sense.get_accelerometer_raw()
    x = acceleration['x']
    y = acceleration['y']
    z = acceleration['z']
    if abs(x) > 1.5 or abs(y) > 1.5 or abs(z) > 1.5:
        sense.show_message("Shake!", scroll_speed=0.08, text_colour=(255, 255, 0))
    time.sleep(0.2)

# -------------------------
# 8. Clear the LED Matrix
# -------------------------
sense.clear()
print("All tests complete. LED matrix cleared.")
